<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>C++ Primer | Epoch</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./assets/img/logo.ico">
    <meta name="description" content="Epoch&#39;s Blog">
    <meta name="author" content="Epoch">
    <meta name="keywords" content="Epochs Blog Basted On VuePress.">
    
    <link rel="preload" href="/blog/assets/css/0.styles.19413b44.css" as="style"><link rel="preload" href="/blog/assets/js/app.a976d4b9.js" as="script"><link rel="preload" href="/blog/assets/js/2.077fc20b.js" as="script"><link rel="preload" href="/blog/assets/js/7.5a85f1a5.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.c59a72b7.js"><link rel="prefetch" href="/blog/assets/js/11.2f51997e.js"><link rel="prefetch" href="/blog/assets/js/12.4c6b6d39.js"><link rel="prefetch" href="/blog/assets/js/13.8c9bf63c.js"><link rel="prefetch" href="/blog/assets/js/14.375a22b6.js"><link rel="prefetch" href="/blog/assets/js/15.630ac74c.js"><link rel="prefetch" href="/blog/assets/js/16.f9efd192.js"><link rel="prefetch" href="/blog/assets/js/17.710968ef.js"><link rel="prefetch" href="/blog/assets/js/18.e98248c3.js"><link rel="prefetch" href="/blog/assets/js/19.4dca1550.js"><link rel="prefetch" href="/blog/assets/js/20.ed86343f.js"><link rel="prefetch" href="/blog/assets/js/21.501b2f8f.js"><link rel="prefetch" href="/blog/assets/js/22.d3b58b1c.js"><link rel="prefetch" href="/blog/assets/js/23.9bf8a256.js"><link rel="prefetch" href="/blog/assets/js/24.9b3b0f9c.js"><link rel="prefetch" href="/blog/assets/js/25.2f925885.js"><link rel="prefetch" href="/blog/assets/js/26.1bf62e76.js"><link rel="prefetch" href="/blog/assets/js/27.3f7bc42a.js"><link rel="prefetch" href="/blog/assets/js/28.8bb4c4dd.js"><link rel="prefetch" href="/blog/assets/js/29.c6ffb896.js"><link rel="prefetch" href="/blog/assets/js/3.87def374.js"><link rel="prefetch" href="/blog/assets/js/30.98fc8e51.js"><link rel="prefetch" href="/blog/assets/js/31.7f306c76.js"><link rel="prefetch" href="/blog/assets/js/32.bf1c9517.js"><link rel="prefetch" href="/blog/assets/js/33.7e1a42c9.js"><link rel="prefetch" href="/blog/assets/js/34.49813caa.js"><link rel="prefetch" href="/blog/assets/js/35.8e496e16.js"><link rel="prefetch" href="/blog/assets/js/36.c394458b.js"><link rel="prefetch" href="/blog/assets/js/37.409d9fcc.js"><link rel="prefetch" href="/blog/assets/js/38.4970fb9b.js"><link rel="prefetch" href="/blog/assets/js/4.4e1a7e2a.js"><link rel="prefetch" href="/blog/assets/js/5.f2ca250f.js"><link rel="prefetch" href="/blog/assets/js/6.db1d3ebc.js"><link rel="prefetch" href="/blog/assets/js/8.1dbfb293.js"><link rel="prefetch" href="/blog/assets/js/9.168f1830.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.19413b44.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="./assets/img/logo.png" alt="Epoch" class="logo"> <span class="site-name can-hide">Epoch</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/CPP/C++ Primer.html" class="nav-link">
  CPP
</a></div><div class="nav-item"><a href="/blog/MySQL/" class="nav-link">
  MySQL
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet" class="dropdown-title"><span class="title">Internet</span> <span class="arrow down"></span></button> <button type="button" aria-label="Internet" class="mobile-dropdown-title"><span class="title">Internet</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Internet/Frame.html" class="nav-link">
  Frame
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/HTTP/Http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/TCP&amp;IP/IP.html" class="nav-link">
  TCP&amp;IP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="others" class="dropdown-title"><span class="title">others</span> <span class="arrow down"></span></button> <button type="button" aria-label="others" class="mobile-dropdown-title"><span class="title">others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/others/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/Binary Tree Traversal.html" class="nav-link">
  Binary Tree Traversal
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/CPP/C++ Primer.html" class="nav-link">
  CPP
</a></div><div class="nav-item"><a href="/blog/MySQL/" class="nav-link">
  MySQL
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet" class="dropdown-title"><span class="title">Internet</span> <span class="arrow down"></span></button> <button type="button" aria-label="Internet" class="mobile-dropdown-title"><span class="title">Internet</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Internet/Frame.html" class="nav-link">
  Frame
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/HTTP/Http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/TCP&amp;IP/IP.html" class="nav-link">
  TCP&amp;IP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="others" class="dropdown-title"><span class="title">others</span> <span class="arrow down"></span></button> <button type="button" aria-label="others" class="mobile-dropdown-title"><span class="title">others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/others/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/Binary Tree Traversal.html" class="nav-link">
  Binary Tree Traversal
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>CPP</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/CPP/C++ Primer.html" class="active sidebar-link">C++ Primer</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第二章-variable" class="sidebar-link">第二章: Variable</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第三章-string-vector-array" class="sidebar-link">第三章：String Vector Array</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第四章-expression" class="sidebar-link">第四章：Expression</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第六章-function" class="sidebar-link">第六章：Function</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第七章-class" class="sidebar-link">第七章：Class</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第八章-io-library" class="sidebar-link">第八章: IO Library</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第九章-sequential-container" class="sidebar-link">第九章: Sequential Container</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十章-generic-algorithm" class="sidebar-link">第十章: Generic Algorithm</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十一章-associative-container" class="sidebar-link">第十一章: Associative Container</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十二章-dynamic-memory" class="sidebar-link">第十二章: Dynamic Memory</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十三章-copy-control" class="sidebar-link">第十三章: Copy Control</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十四章-overload-operator-type-conversion" class="sidebar-link">第十四章: Overload Operator &amp; Type Conversion</a></li><li class="sidebar-sub-header"><a href="/blog/CPP/C++ Primer.html#第十五章-object-oriented-programming" class="sidebar-link">第十五章: Object Oriented Programming</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="c-primer"><a href="#c-primer" class="header-anchor">#</a> C++ Primer</h1> <h2 id="第二章-variable"><a href="#第二章-variable" class="header-anchor">#</a> 第二章: Variable</h2> <ol><li>头文件不应包含<code>using</code>声明，因为头文件会被<code>copy</code>到所有引用其的文件中。</li></ol> <h3 id="decltype-expresssion"><a href="#decltype-expresssion" class="header-anchor">#</a> decltype(expresssion)</h3> <ul><li>类型推导</li> <li>如果expression含括号，则一定是引用类型。</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span><span class="token operator">&amp;</span> j <span class="token operator">=</span> i<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//int</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> b <span class="token operator">=</span> i<span class="token punctuation">;</span> <span class="token comment">//b是引用</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> c <span class="token operator">=</span> a<span class="token punctuation">;</span> <span class="token comment">//c是引用类型</span>
</code></pre></div><h2 id="第三章-string-vector-array"><a href="#第三章-string-vector-array" class="header-anchor">#</a> 第三章：String Vector Array</h2> <h3 id="string"><a href="#string" class="header-anchor">#</a> String</h3> <blockquote><p>列表初始化和拷贝初始化、直接初始化的区别</p></blockquote> <p><code>string::size_type</code>和<code>size_t</code>有助于代码的可移植性。 根据不同平台，编译成不同大小。</p> <h3 id="vector"><a href="#vector" class="header-anchor">#</a> Vector</h3> <ol><li><code>vector</code>对象能高速增长，除了所有元素都一样的情况，没必要定义时指定容量。</li></ol> <h3 id="array"><a href="#array" class="header-anchor">#</a> Array</h3> <ol><li><p>定义（有括号优先括号，其次右向左读）</p> <div class="language-Cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token operator">*</span>ptrs<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//是一个数组， 里头10个指针</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>refs<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">;</span> <span class="token comment">// 错误，不存在引用数组</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>Parray<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">;</span> <span class="token comment">// 指针，指向一个数组，数组包含10个元素</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>arrRef<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> arr<span class="token punctuation">;</span> <span class="token comment">//引用，引用一个数组，数组包含10个元素</span>
<span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>array<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> ptrs <span class="token comment">//引用，引用一个数组，数组包含10个元素，数组元素是指针。</span>
</code></pre></div></li> <li><p>编译器编译,<code>auto</code>,为指针，<code>decltype()</code>为原类型。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span> <span class="token function">arr2</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//指针</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span> <span class="token function">arr3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//int型数组</span>
</code></pre></div></li> <li><p>指针也是迭代器，可获取尾后迭代器遍历数组。但建议使用<code>begin()</code>和<code>end()</code>获取迭代器。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>first <span class="token operator">=</span> <span class="token function">begin</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>last <span class="token operator">=</span> <span class="token operator">&amp;</span>arr<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token comment">//不建议</span>
<span class="token keyword">int</span> <span class="token operator">*</span>last <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//建议</span>
</code></pre></div></li> <li><p>指针相减得到数据类型<code>ptrdiff_t</code>, 为有符号类型</p></li> <li><p>静态多维数组需要使用引用。</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span><span class="token operator">&amp;</span> row<span class="token operator">:</span> arr<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">//如果不是引用，编译器认为是 int*, col无法遍历。</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> col<span class="token operator">:</span> row<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> col <span class="token operator">&lt;&lt;</span>endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h2 id="第四章-expression"><a href="#第四章-expression" class="header-anchor">#</a> 第四章：Expression</h2> <ol><li>左值和右值</li></ol> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token comment">//*p, 解引用。为int&amp;</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>p<span class="token punctuation">)</span> <span class="token comment">//&amp;p取地址为右值。为int**</span>
</code></pre></div><ol start="2"><li><p>求值顺序（CPP没有明确规定求值顺序，方便编译器优化）</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token function">f2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//不确定先算f2还是f1，未定义行为。</span>
<span class="token comment">//确定求值顺序运算符有四个：&amp;&amp; || , ? :</span>
</code></pre></div></li> <li><p>位运算符</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">1111</span><span class="token punctuation">;</span>
a <span class="token operator">&amp;=</span> <span class="token operator">~</span><span class="token punctuation">(</span>a <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>sizeof</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">;</span>
<span class="token keyword">sizeof</span> <span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//没错，实际不对p解引用。返回p指向的大小。在这为int类型大小  </span>
<span class="token keyword">sizeof</span> <span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//返回p指针本身大小</span>
<span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">sizeof</span> arr<span class="token punctuation">;</span> <span class="token comment">//返回10，数组所占大小。</span>
string s<span class="token punctuation">{</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">sizeof</span> s<span class="token punctuation">;</span> <span class="token comment">// 返回其固有所占空间大小，不随s长度改变。vector同理</span>
</code></pre></div></li> <li><p>类型转换</p> <ol><li><p>隐式转换</p></li> <li><p>显示转换<code>static_cast&lt;&gt;()</code>、<code>const_cast&lt;&gt;()</code>、<code>dynamic_cast&lt;&gt;()</code>、<code>reinterrpret_cast&lt;&gt;()</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">float</span> a <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
<span class="token keyword">double</span> res <span class="token operator">=</span> <span class="token generic-function"><span class="token function">static_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>pc<span class="token punctuation">;</span>
<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token generic-function"><span class="token function">const_cast</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token operator">*</span><span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span>pc<span class="token punctuation">)</span><span class="token comment">//去除底层const，但是通过p写值是未定义的行为。</span>
</code></pre></div></li></ol></li></ol> <h2 id="第六章-function"><a href="#第六章-function" class="header-anchor">#</a> 第六章：Function</h2> <ol><li><p><code>initializer_list&lt;&gt;</code>初始化列表</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>initializer_list<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> lst<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">vec</span><span class="token punctuation">(</span>lst<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{}实际上是一个初始化列表。</span>
<span class="token comment">//作为函数返回值，用于初始化被调用处的变量。</span>
vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">fun1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">//实际上是一个初始化列表。</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>返回数组指针</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//方法1</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//逐层理解</span>
<span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//函数需要一个int参数</span>
<span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//函数返回值可以解引用</span>
<span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//函数解引用得到一个大小为10的数组</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">//数组中的元素大小为10;</span>
<span class="token comment">//方法2：使用尾置返回类型</span>
<span class="token keyword">auto</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>调试帮助</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">NDEBUG</span> <span class="token comment">//在源文件的第一句写,用于取消以下模式 </span></span>
<span class="token comment">//方法一</span>
<span class="token function">assert</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//expr为0则输出信息并终止程序.</span>
<span class="token comment">//方法二</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">NDEBUG</span></span>
	some opreation
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre></div></li> <li><p>函数指针</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//(*pf)代表是一个指针,右边的参数列表表示指向一个函数.</span>
</code></pre></div></li> <li><p>函数指针形参</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">useBigger</span><span class="token punctuation">(</span><span class="token keyword">bool</span> <span class="token punctuation">(</span><span class="token operator">*</span>pf<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">const</span> string<span class="token operator">&amp;</span> a<span class="token punctuation">,</span> <span class="token keyword">const</span> string<span class="token operator">&amp;</span> b<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">useBigger</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span><span class="token comment">//调用时直接传函数名即可.</span>
<span class="token keyword">decltype</span><span class="token punctuation">(</span>func<span class="token punctuation">)</span> <span class="token operator">*</span> funcPtr<span class="token punctuation">;</span> <span class="token comment">//通过decltype得到函数类型,加上*变成函数指针.</span>
<span class="token comment">//可以如下重新声明useBigger函数</span>
<span class="token keyword">void</span> <span class="token function">useBigger</span><span class="token punctuation">(</span>funcPtr<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>返回指向函数的指针</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//使用别名</span>
<span class="token keyword">using</span> F <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//F是函数类型,不是指针.</span>
<span class="token keyword">using</span> PF <span class="token operator">=</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//PF是函数指针</span>
PF <span class="token function">f1</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
F <span class="token operator">*</span><span class="token function">f2</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//F 是一个函数,加上*变成函数指针.</span>
<span class="token comment">//直接声明</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token function">f1</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//尾置返回</span>
<span class="token keyword">auto</span> <span class="token function">f3</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <h2 id="第七章-class"><a href="#第七章-class" class="header-anchor">#</a> 第七章：Class</h2> <ol><li><p>对于公共代码使用私有功能函数</p> <ol><li>避免在多处使用同样的代码</li> <li>随着规模发展, 函数的功能可能变得更复杂, 修改时只需修改一处即可.</li> <li>可能在开发时有调试信息, 发行版去除函数处的即可.</li> <li>不带来额外开销, <strong>类的函数定义在内部会隐式声明成inline类型</strong>.</li></ol></li> <li><p>函数的参数列表可以告诉编译器目前处于哪个作用域</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token class-name">Window_mgr</span><span class="token double-colon punctuation">::</span> <span class="token function">addScreen</span><span class="token punctuation">(</span><span class="token keyword">const</span> Screen <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 但是返回值在这个作用域参数之前,因此需要指明.</span>
Window_mgr<span class="token double-colon punctuation">::</span>ScreenIndex
<span class="token class-name">Window_mgr</span><span class="token double-colon punctuation">::</span><span class="token function">addScreen</span><span class="token punctuation">(</span>cosnt Screen <span class="token operator">&amp;</span>s<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>编译器处理完所有声明才会处理成员函数的定义.</p> <ol><li>对于成员函数中的使用的名字, 可以使用类中所有的成员变量.</li> <li>但对于声明, 返回值, 参数列表中使用的名字, 都必须保证使用前可见.</li></ol> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">typedef</span> <span class="token keyword">double</span> Money<span class="token punctuation">;</span>
string bar<span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Account</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//返回值类型是double, bar是下方的bar1.0, 而非上方的string.</span>
    Money <span class="token function">balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> bar<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    Money bar <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>成员初始化的顺序</p> <ol><li><p>实际顺序与其定义的顺序一致.</p></li> <li><p>编码顺序可以不一致, 需要考虑如下问题</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">X</span><span class="token punctuation">{</span>
    <span class="token keyword">int</span> i<span class="token punctuation">;</span>
    <span class="token keyword">int</span> j<span class="token punctuation">;</span>  
    <span class="token function">X</span><span class="token punctuation">(</span><span class="token keyword">int</span> val<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">j</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">x</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//未定义行为, 因为实际顺序中, i先被初始化.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></li> <li><p>委托构造（构造函数调用其他构造函数）</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">SaleData</span><span class="token punctuation">{</span>
    string id<span class="token punctuation">;</span>
    <span class="token keyword">double</span> price<span class="token punctuation">;</span>
    <span class="token function">SaleData</span><span class="token punctuation">(</span>string id<span class="token punctuation">,</span> <span class="token keyword">double</span> price<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">id</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">price</span><span class="token punctuation">(</span>price<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">SaleData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">SaleData</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">saleData</span><span class="token punctuation">(</span>string id<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">SaleData</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>默认构造函数</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>SaleData <span class="token function">obj</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//函数声明</span>
SaleData obj<span class="token punctuation">;</span> <span class="token comment">//对象声明, 调用默认构造函数.</span>
</code></pre></div></li> <li><p>转换构造函数</p> <ol><li>例子</li></ol> <div class="language-cpp extra-class"><pre class="language-cpp"><code>string null_book <span class="token operator">=</span> <span class="token string">&quot;9-999-9999-9&quot;</span><span class="token punctuation">;</span> <span class="token comment">//此处存在一次隐式转换 即const char *到string</span>
SaleData temp <span class="token operator">=</span> null_book<span class="token punctuation">;</span> 
SaleData temp <span class="token operator">=</span> <span class="token string">&quot;9-999-9999-9&quot;</span><span class="token punctuation">;</span><span class="token comment">// 不行, 只支持一步转换. </span>
</code></pre></div><ol start="2"><li>explicit关键字 阻止隐式转换</li></ol></li> <li><p>聚合类</p> <ol><li><p>符合如下条件</p> <ul><li>所有成员都是<code>public</code>的</li> <li>没有定义任何构造函数</li> <li>没有类内初始值</li> <li>没有基类, 也没有<code>virtual</code>函数</li></ul></li> <li><p>如</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> val<span class="token punctuation">;</span>
    string s<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>可以如下初始化</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>Data data1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;Anna&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//赋值顺序与定义顺序一致</span>
</code></pre></div></li></ol></li> <li><p>字面值常量类(成员都是字面值的聚合类或者符合以下条件)</p> <ul><li>数据成员必须是字面值类型</li> <li>类至少含有一个<code>constexpr</code>构造函数</li> <li>类内初始值为常量表达式, 或者初始值使用自己的<code>constexpr</code>构造函数初始化.</li> <li>析构函数必须默认</li></ul></li> <li><p>类的静态成员</p> <ul><li>定义在任何函数之外, 定义后存在于整个程序的生命周期.</li> <li><strong>建议把静态数据成员的定义与其他非<code>inline</code>函数的定义在同一个文件中.</strong></li> <li>一般来说,不应该在类内初始化, 但可以提供为<code>const</code>静态成员提供类内初始值(必须是字面值或<code>constexpr</code>)</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">constexpr</span> <span class="token keyword">static</span> <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// 正确</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">//报错, 非const的static变量的定义和初始化必须分开.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//正确</span>
<span class="token keyword">class</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">int</span> count<span class="token punctuation">;</span> <span class="token comment">//类内定义</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> Data<span class="token double-colon punctuation">::</span>count <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">//类外初始化</span>
</code></pre></div><ul><li>即使一个常量静态数据成员在类内部被初始化, 通常情况下也应该在类外定义一下.</li></ul> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Data</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">constexpr</span> <span class="token keyword">static</span> <span class="token keyword">int</span> cnt <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">constexpr</span> <span class="token keyword">int</span> Data<span class="token double-colon punctuation">::</span>cnt<span class="token punctuation">;</span>
</code></pre></div><ul><li><p>静态数据成员类型可以是不完全类型.</p></li> <li><p>可以作为默认实参</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Screen</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    Screen<span class="token operator">&amp;</span> <span class="token function">clear</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">=</span> bkground<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span> bkground<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul></li></ol> <ul><li><code>mutable</code>可以突破函数<code>const</code>的限制, 任何时候都可改;</li></ul> <h2 id="第八章-io-library"><a href="#第八章-io-library" class="header-anchor">#</a> 第八章: IO Library</h2> <ol><li><p>宽字符版本输入输出流 <code>wcin</code>, <code>wcout</code>,<code>wcerr</code>,与原版本在同一个头文件.</p></li> <li><p>流状态管理</p></li> <li><p>管理输出缓冲: <strong>如果程序崩溃,输出缓冲区不会被刷新</strong></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>cout <span class="token operator">&lt;&lt;</span> unitbuf<span class="token punctuation">;</span> <span class="token comment">//设置模式:任何输出都会立即刷新缓冲区</span>
cout <span class="token operator">&lt;&lt;</span> nounitbuf <span class="token comment">//恢复默认</span>
</code></pre></div><ol><li><p>关联输入和输出流</p> <blockquote><p>关联后, 任何输入流读取操作都会先刷新关联的输出流.</p></blockquote> <div class="language-cpp extra-class"><pre class="language-cpp"><code>cin <span class="token operator">&gt;&gt;</span> ival<span class="token punctuation">;</span> <span class="token comment">//标准库将cout和cin关联, 因此这会使得cout刷新.</span>
cin<span class="token punctuation">.</span><span class="token function">tie</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>cerr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 关联cerr流.</span>
</code></pre></div></li></ol></li> <li><p>文件输入输出流</p> <ol><li><code>open</code>和<code>close</code>, 文件流对象被销毁时.自动调用<code>close</code></li> <li>string流 :<code>istringstream</code>, <code>ostringstream</code></li></ol></li></ol> <h2 id="第九章-sequential-container"><a href="#第九章-sequential-container" class="header-anchor">#</a> 第九章: Sequential Container</h2> <ol><li><p>顺序容器类型</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>vector<span class="token punctuation">;</span> 
deque<span class="token punctuation">;</span> 
list<span class="token punctuation">;</span> <span class="token comment">//双向链表 </span>
forward_list<span class="token punctuation">;</span> <span class="token comment">//单向链表</span>
array<span class="token punctuation">;</span>
string<span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>capacity</code>和<code>size</code></p> <ol><li><code>capacity</code>表示当前分配的空间最大容纳元素个数</li> <li><code>size</code>是当前容器存储元素个数.</li></ol> <div class="language-cpp extra-class"><pre class="language-cpp"><code>vector<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> vec<span class="token punctuation">;</span>
vec<span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//指定vec分配n个元素的内存空间. 此时capacity = n; </span>
</code></pre></div></li></ol> <h2 id="第十章-generic-algorithm"><a href="#第十章-generic-algorithm" class="header-anchor">#</a> 第十章: Generic Algorithm</h2> <ol><li><p>只要元素支持相关操作,例如<code>+</code>, <code>==</code>即可调用泛型算法.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>string sum <span class="token operator">=</span> <span class="token function">accumulate</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">string</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//支持+即可</span>
<span class="token function">equal</span><span class="token punctuation">(</span>v<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span> v<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> v2<span class="token punctuation">.</span><span class="token function">cbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//支持==即可</span>
</code></pre></div></li> <li><p>算法不检查写操作</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token function">finll_n</span><span class="token punctuation">(</span>vec<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//若vec大小小于10, 则此操作未定义.</span>
</code></pre></div></li> <li><p><code>lambda</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token punctuation">[</span>capture list<span class="token punctuation">]</span> <span class="token punctuation">(</span>parameter list<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> returnType <span class="token punctuation">{</span>
    function body
<span class="token punctuation">}</span>
<span class="token comment">//capture list只用于局部非static变量, lambda可以直接使用局部static变量和在它所在函数之外声明的名字</span>
</code></pre></div><ol><li><p>值捕获和引用捕获</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
<span class="token comment">//显式捕获</span>
<span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">//value</span>
<span class="token keyword">auto</span> f2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span>a<span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">//reference</span>
<span class="token comment">//隐式捕获</span>
<span class="token keyword">auto</span> f <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">//value</span>
<span class="token keyword">auto</span> f2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> a<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token comment">// reference</span>
<span class="token comment">//capture list</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span>name1<span class="token punctuation">,</span> names2<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">&amp;</span><span class="token punctuation">,</span> identifier_list<span class="token punctuation">]</span>
<span class="token punctuation">[</span><span class="token operator">=</span><span class="token punctuation">,</span> identifier_lsit<span class="token punctuation">]</span>
</code></pre></div></li></ol></li> <li><p><code>bind</code></p> <ol><li>使用<code>bind</code>取代lambda</li></ol></li> <li><p>插入迭代器</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>back_inserter<span class="token punctuation">;</span>
front_inserter<span class="token punctuation">;</span>
inserter<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>算法命名规范</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token function">find</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">find</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> comp<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//参数都是三个,避免重载歧义, 提供不同名字版本</span>
<span class="token function">find_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> pred<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//拷贝和不拷贝</span>
<span class="token function">reverse</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">reverse_copy</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> dest<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">remove_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">remove_copy_if</span><span class="token punctuation">(</span>beg<span class="token punctuation">,</span> end<span class="token punctuation">,</span> v2<span class="token punctuation">.</span><span class="token function">beg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">return</span> i <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>特定容器算法</p> <p>对于<code>list</code>和<code>forward_list</code>优先使用成员算法.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>sort<span class="token punctuation">;</span>
merge<span class="token punctuation">;</span>
remove<span class="token punctuation">;</span>
reverse<span class="token punctuation">;</span>
unique<span class="token punctuation">;</span>
</code></pre></div><p>链表的特有操作会改变容器</p></li></ol> <h2 id="第十一章-associative-container"><a href="#第十一章-associative-container" class="header-anchor">#</a> 第十一章: Associative Container</h2> <ol><li><p>8种</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>map<span class="token punctuation">;</span>
set<span class="token punctuation">;</span>
multimap<span class="token punctuation">;</span>
multiset<span class="token punctuation">;</span>
unordered_map<span class="token punctuation">;</span>
unordered_set<span class="token punctuation">;</span>
unordered_multimap<span class="token punctuation">;</span>
unoreered_multiset<span class="token punctuation">;</span>
</code></pre></div></li> <li><p>有序容器的元素需要提供<code>&lt;</code>运算, 无序容器需要提供<code>hash function</code>和<code>==</code></p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Sale_data</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    string isbn<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

size_t <span class="token function">hashFunc</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sale_data <span class="token operator">&amp;</span>t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token generic-function"><span class="token function">hash</span><span class="token generic class-name"><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span></span></span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>t<span class="token punctuation">.</span>isbn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">bool</span> <span class="token function">eqOp</span><span class="token punctuation">(</span><span class="token keyword">const</span> Sale_data <span class="token operator">&amp;</span>t1<span class="token punctuation">,</span> <span class="token keyword">const</span> Sale_data <span class="token operator">&amp;</span>t2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">hashFunc</span><span class="token punctuation">(</span>t1<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">hashFunc</span><span class="token punctuation">(</span>t2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    unordered_set<span class="token operator">&lt;</span>Sale_data<span class="token punctuation">,</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>hashFunc<span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">,</span> <span class="token keyword">decltype</span><span class="token punctuation">(</span>eqOp<span class="token punctuation">)</span><span class="token operator">*</span><span class="token operator">&gt;</span> test<span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> test<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>无序容器桶管理</p></li></ol> <h2 id="第十二章-dynamic-memory"><a href="#第十二章-dynamic-memory" class="header-anchor">#</a> 第十二章: Dynamic Memory</h2> <ol><li><p>动态内存与智能指针</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>shared_ptr<span class="token punctuation">;</span>
unique_ptr<span class="token punctuation">;</span>

shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> p <span class="token operator">=</span> <span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">auto</span> p1 <span class="token operator">=</span> <span class="token generic-function"><span class="token function">make_shared</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token comment">//分配动态内存与删除</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> p<span class="token punctuation">;</span> <span class="token comment">//数组要加[]</span>
</code></pre></div></li> <li><p>使用动态内存的原因是允许多个对象共享相同的状态.</p></li> <li><p>相关<code>shared_ptr</code>的定义和修改</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//q是new出来的内存, 且能转成T*</span>
shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//u是unique_ptr, 从u处接管对象所有权. u置空.</span>
shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//q是内置指针,p接管其内存, 同时用d来代替delete来释放内存.</span>
shared_ptr<span class="token operator">&lt;</span>T<span class="token operator">&gt;</span> <span class="token function">p</span><span class="token punctuation">(</span>p2<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//接管shared_ptr p2, 并用d释放内存.</span>

p<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">;</span>
p<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>传递删除器</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>unique_ptr<span class="token operator">&lt;</span>objT<span class="token punctuation">,</span> decT<span class="token operator">*</span><span class="token operator">&gt;</span> <span class="token function">p</span> <span class="token punctuation">(</span><span class="token keyword">new</span> ObjT<span class="token punctuation">,</span> fcn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>weark_ptr</code></p></li> <li><p>智能指针与动态数组</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code>unique_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token function">up</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
up<span class="token punctuation">.</span><span class="token function">release</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//自动调用delete[]销毁其指针</span>
<span class="token comment">//shared_ptr 与 unique_ptr不同, 不支持管理动态数组, 需要自定义删除器.</span>
shared_ptr<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">sp</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>allocator</code></p> <ol><li>分配未构造的内存, 将内存分配与对象构造分隔开.</li> <li>分配与回收, 构造与析构</li> <li>拷贝和填充分配但未构造的内存</li></ol></li></ol> <h2 id="第十三章-copy-control"><a href="#第十三章-copy-control" class="header-anchor">#</a> 第十三章: Copy Control</h2> <ol><li><p>拷贝构造函数和拷贝赋值运算符</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Foo</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//拷贝构造函数, 形参必须是引用, 不然会无限拷贝</span>
    Foo<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token comment">//拷贝赋值</span>
    
    <span class="token comment">//或默认生成, synthesized copy constructor</span>
    <span class="token comment">//或显示赋值default, 如下</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    Foo<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span> o<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//在类外</span>
    <span class="token operator">~</span><span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    
    <span class="token comment">//或删除</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token function">Foo</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>
    Foo<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span> o<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">delete</span><span class="token punctuation">;</span>
    <span class="token operator">~</span><span class="token function">Foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Foo<span class="token operator">&amp;</span> Foo<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Foo<span class="token operator">&amp;</span> o<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> <span class="token comment">//防止inline.</span>
</code></pre></div></li> <li><p>需要析构函数的类也需要拷贝和赋值操作（显式生成拷贝构造函数、重载=运算符）,需要拷贝的类也需要赋值操作，反之亦然。</p></li> <li><p>类值拷贝赋值运算符</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token comment">//需要注意当左右两侧是同一个对象时, 保证正确性和异常安全.</span>
HasPtr<span class="token operator">&amp;</span>
HasPtr<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr<span class="token operator">&amp;</span> rhs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">delete</span> ps<span class="token punctuation">;</span> <span class="token comment">// 释放ps指向的动态内存</span>
    <span class="token comment">//如果rhs和*this是同一对象, 行为未定义</span>
    ps <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">string</span> <span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">(</span>rhs<span class="token punctuation">.</span>ps<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">//copy and swap</span>
HasPtr<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> HasPtr rhs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">swap</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">,</span> rhs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>自定义<code>swap</code>函数而非<code>std::swap</code>交换指针, 防止冗余拷贝.</p></li> <li><p>右值引用 <code>&amp;&amp;</code></p></li> <li><p>对象移动</p> <ol><li><p>容器保存的类不必可以拷贝, 但一定要可以移动.</p></li> <li><p><strong>移动构造函数</strong>(需要dynamic memory除外, 可能分配失败)通常不会抛出异常, 需要声明成<code>noexcept</code>, 原因如下:</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">public</span><span class="token operator">:</span>
	<span class="token function">StrVec</span><span class="token punctuation">(</span>StrVec<span class="token operator">&amp;&amp;</span><span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token comment">// 类头文件声明, 和定义都指定noexcept</span>
<span class="token class-name">StrVec</span><span class="token double-colon punctuation">::</span><span class="token function">StrVec</span><span class="token punctuation">(</span>StrVec <span class="token operator">&amp;&amp;</span>o<span class="token punctuation">)</span> <span class="token keyword">noexcept</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>原因:</strong> 移动构造时, 在当前对象已经移动部分, 但未完全移动时发生异常, 容器就会发生改变.因此 容器就不会选用会抛出异常的移动构造函数, 而选用拷贝构造, 因为拷贝构造构造发生异常时, 旧元素仍然存在, 仅需释放新元素内存即可保持容器不变.</p></li> <li><p><strong>移动赋值运算符</strong></p> <ol><li>类似拷贝赋值, 需要确保自己给自己赋值的正确性.</li></ol></li></ol></li> <li><p>五个拷贝控制成员应该看成一个整体.</p> <ol><li>构造析构移动:</li> <li>赋值, 拷贝:</li></ol></li></ol> <h2 id="第十四章-overload-operator-type-conversion"><a href="#第十四章-overload-operator-type-conversion" class="header-anchor">#</a> 第十四章: Overload Operator &amp; Type Conversion</h2> <ol><li><p><code>function</code>类型</p> <ol><li>可通过函数, 函数指针 ,lambda, 函数对象构造.</li></ol></li> <li><p>类型转换运算符</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">SmallInt</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">SmallInt</span><span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">operator</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">//转换成int, 通常设置成const</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> val<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>	
</code></pre></div></li> <li><p>不要设计两个可以转换的类, 一个转换构造一个定义类型转换运算符</p></li> <li><p>不要定义多种内置算术类型的类型转换.</p></li> <li><p>转换构造和类型转换可能产生二义性，因此推荐转换构造</p></li></ol> <h2 id="第十五章-object-oriented-programming"><a href="#第十五章-object-oriented-programming" class="header-anchor">#</a> 第十五章: Object Oriented Programming</h2> <ol><li><p><code>virtual</code></p></li> <li><p>动态绑定</p></li> <li><p><code>final</code> 防止被该类继承</p></li> <li><p>多态: <code>polymorphism</code></p></li> <li><p>纯虚函数<code>pure virtual</code>, 有该类函数的类称为抽象基类<code>abstract base class</code>, 无法被直接定义.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Disc_quete</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Quote</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Disc_quote</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token keyword">double</span> <span class="token function">net_price</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span>size_t<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">//纯虚函数只需声明, = 0即可</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>派生类的成员或友元只能通过派生类对象来访问基类的受保护成员. 基类对象不行.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Base</span> <span class="token punctuation">{</span>
<span class="token keyword">protected</span><span class="token operator">:</span>
   	<span class="token keyword">int</span> prot_mem<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Sneaky</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">clobber</span> <span class="token punctuation">(</span>Sneaky<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//能访问</span>
    <span class="token keyword">friend</span> <span class="token keyword">void</span> <span class="token function">clobber</span> <span class="token punctuation">(</span>Base<span class="token operator">&amp;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//不能通过基类对象访问</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>继承方式:<code>public</code>,<code>proteced</code>&amp;<code>private</code>;</p> <ul><li><p>不影响基类的访问权限.</p></li> <li><p>仅仅控制派生类对象对基类的访问.</p></li> <li><p>通过<code>using</code>改变个别成员的可访问性. 前提是该成员可在派生类内访问.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Derived</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">private</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">using</span>  base<span class="token double-colon punctuation">::</span>var<span class="token punctuation">;</span><span class="token comment">//改变base基类的var变量访问权限为public</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul></li> <li><p><code>friend</code>不能继承给派生类</p></li> <li><p>名字查找先于类型检查, 因此内层作用域的函数会隐藏外层的函数, 即使他们<strong>参数列表不一致</strong>,</p> <ol><li>因此虚函数一定要有相同的参数列表.</li> <li>内层同名函数会隐藏所有外层同名函数(可能是重载函数,因此可能有多个),可通过基类<code>::</code>访问.</li></ol></li> <li><p>虚析构函数</p> <ol><li>一个基类总是需要虚析构函数</li> <li>会阻止合成移动操作.因此使用移动操作时, 实际使用的是拷贝操作.</li></ol></li> <li><p>移动操作与继承</p> <ol><li><p>基类操作</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Base</span><span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token operator">~</span><span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span> <span class="token comment">//基类通常需要定义虚析构函数</span>
    <span class="token comment">//定义析构函数后, 不会默认合成移动操作. 需要显式定义,如下.</span>
    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token function">Base</span><span class="token punctuation">(</span><span class="token keyword">const</span> Base<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token function">Base</span><span class="token punctuation">(</span>Base<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    Base<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> Base<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    Base<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>Base<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>派生类操作</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">D</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span><span class="token operator">:</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//D(const D&amp; t) = default;</span>
 	<span class="token comment">//=default会使用默认初始化, 与我们的期望相违背.</span>
    <span class="token function">D</span><span class="token punctuation">(</span><span class="token keyword">const</span> D<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token keyword">default</span><span class="token punctuation">;</span>
    <span class="token function">D</span><span class="token punctuation">(</span>D<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span> <span class="token keyword">noexcept</span> <span class="token operator">:</span> <span class="token function">Base</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    D<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> D<span class="token operator">&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    D<span class="token operator">&amp;</span> <span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> D<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token comment">//拷贝和赋值</span>
D<span class="token operator">&amp;</span> D<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token keyword">const</span> D<span class="token operator">&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Base<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//...</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
D<span class="token operator">&amp;</span> D<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span><span class="token punctuation">(</span>D<span class="token operator">&amp;&amp;</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Base<span class="token double-colon punctuation">::</span><span class="token keyword">operator</span><span class="token operator">=</span>std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//...</span>
    <span class="token keyword">return</span> <span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol></li> <li><p>&quot;继承&quot;构造函数, 继承除了</p> <ol><li><p>默认, 拷贝, 移动构造函数</p></li> <li><p>派生类中与基类参数列表相同的构造函数.</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">D</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Base</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">//复制基类的构造函数到派生类, 派生类的成员执行默认初始化.</span>
    <span class="token comment">//且不影响派生类默认构造函数的生成.</span>
    <span class="token keyword">using</span> Base<span class="token double-colon punctuation">::</span>Base<span class="token punctuation">;</span>
    <span class="token comment">//之前的using声明改变了访问权限, 此处不改变, 编译器仅生成代码.</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ol></li> <li><p>容器与继承</p> <ol><li><p>在容器中放置(智能)指针而非对象.</p></li> <li><p>模拟虚拷贝: <code>new Base(obj)</code> <code>obj</code>可能是派生类, 因此可能会仅拷贝<code>Base</code>的部分</p> <div class="language-cpp extra-class"><pre class="language-cpp"><code><span class="token keyword">virtual</span> Base<span class="token operator">*</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">Quote</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">virtual</span> Base<span class="token operator">*</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token function">Quote</span><span class="token punctuation">(</span>std<span class="token double-colon punctuation">::</span><span class="token function">move</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> 
</code></pre></div></li></ol></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.a976d4b9.js" defer></script><script src="/blog/assets/js/2.077fc20b.js" defer></script><script src="/blog/assets/js/7.5a85f1a5.js" defer></script>
  </body>
</html>
