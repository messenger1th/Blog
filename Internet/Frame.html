<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Frame： 从输入网址到显示网页内容， 期间的过程 | Epoch</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="./assets/img/logo.ico">
    <meta name="description" content="Epoch&#39;s Blog">
    <meta name="author" content="Epoch">
    <meta name="keywords" content="Epochs Blog Basted On VuePress.">
    
    <link rel="preload" href="/blog/assets/css/0.styles.19413b44.css" as="style"><link rel="preload" href="/blog/assets/js/app.a976d4b9.js" as="script"><link rel="preload" href="/blog/assets/js/2.077fc20b.js" as="script"><link rel="preload" href="/blog/assets/js/8.1dbfb293.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.c59a72b7.js"><link rel="prefetch" href="/blog/assets/js/11.2f51997e.js"><link rel="prefetch" href="/blog/assets/js/12.4c6b6d39.js"><link rel="prefetch" href="/blog/assets/js/13.8c9bf63c.js"><link rel="prefetch" href="/blog/assets/js/14.375a22b6.js"><link rel="prefetch" href="/blog/assets/js/15.630ac74c.js"><link rel="prefetch" href="/blog/assets/js/16.f9efd192.js"><link rel="prefetch" href="/blog/assets/js/17.710968ef.js"><link rel="prefetch" href="/blog/assets/js/18.e98248c3.js"><link rel="prefetch" href="/blog/assets/js/19.4dca1550.js"><link rel="prefetch" href="/blog/assets/js/20.ed86343f.js"><link rel="prefetch" href="/blog/assets/js/21.501b2f8f.js"><link rel="prefetch" href="/blog/assets/js/22.d3b58b1c.js"><link rel="prefetch" href="/blog/assets/js/23.9bf8a256.js"><link rel="prefetch" href="/blog/assets/js/24.9b3b0f9c.js"><link rel="prefetch" href="/blog/assets/js/25.2f925885.js"><link rel="prefetch" href="/blog/assets/js/26.1bf62e76.js"><link rel="prefetch" href="/blog/assets/js/27.3f7bc42a.js"><link rel="prefetch" href="/blog/assets/js/28.8bb4c4dd.js"><link rel="prefetch" href="/blog/assets/js/29.c6ffb896.js"><link rel="prefetch" href="/blog/assets/js/3.87def374.js"><link rel="prefetch" href="/blog/assets/js/30.98fc8e51.js"><link rel="prefetch" href="/blog/assets/js/31.7f306c76.js"><link rel="prefetch" href="/blog/assets/js/32.bf1c9517.js"><link rel="prefetch" href="/blog/assets/js/33.7e1a42c9.js"><link rel="prefetch" href="/blog/assets/js/34.49813caa.js"><link rel="prefetch" href="/blog/assets/js/35.8e496e16.js"><link rel="prefetch" href="/blog/assets/js/36.c394458b.js"><link rel="prefetch" href="/blog/assets/js/37.409d9fcc.js"><link rel="prefetch" href="/blog/assets/js/38.4970fb9b.js"><link rel="prefetch" href="/blog/assets/js/4.4e1a7e2a.js"><link rel="prefetch" href="/blog/assets/js/5.f2ca250f.js"><link rel="prefetch" href="/blog/assets/js/6.db1d3ebc.js"><link rel="prefetch" href="/blog/assets/js/7.5a85f1a5.js"><link rel="prefetch" href="/blog/assets/js/9.168f1830.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.19413b44.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="./assets/img/logo.png" alt="Epoch" class="logo"> <span class="site-name can-hide">Epoch</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/CPP/C++ Primer.html" class="nav-link">
  CPP
</a></div><div class="nav-item"><a href="/blog/MySQL/" class="nav-link">
  MySQL
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet" class="dropdown-title"><span class="title">Internet</span> <span class="arrow down"></span></button> <button type="button" aria-label="Internet" class="mobile-dropdown-title"><span class="title">Internet</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Internet/Frame.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Frame
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/HTTP/Http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/TCP&amp;IP/IP.html" class="nav-link">
  TCP&amp;IP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="others" class="dropdown-title"><span class="title">others</span> <span class="arrow down"></span></button> <button type="button" aria-label="others" class="mobile-dropdown-title"><span class="title">others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/others/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/Binary Tree Traversal.html" class="nav-link">
  Binary Tree Traversal
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/CPP/C++ Primer.html" class="nav-link">
  CPP
</a></div><div class="nav-item"><a href="/blog/MySQL/" class="nav-link">
  MySQL
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Internet" class="dropdown-title"><span class="title">Internet</span> <span class="arrow down"></span></button> <button type="button" aria-label="Internet" class="mobile-dropdown-title"><span class="title">Internet</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/Internet/Frame.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Frame
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/HTTP/Http.html" class="nav-link">
  HTTP
</a></li><li class="dropdown-item"><!----> <a href="/blog/Internet/TCP&amp;IP/IP.html" class="nav-link">
  TCP&amp;IP
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="others" class="dropdown-title"><span class="title">others</span> <span class="arrow down"></span></button> <button type="button" aria-label="others" class="mobile-dropdown-title"><span class="title">others</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/others/Git.html" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/blog/others/Binary Tree Traversal.html" class="nav-link">
  Binary Tree Traversal
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Internet</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/Internet/Frame.html" aria-current="page" class="active sidebar-link">Frame： 从输入网址到显示网页内容， 期间的过程</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/Internet/Frame.html#流程" class="sidebar-link">流程</a></li><li class="sidebar-sub-header"><a href="/blog/Internet/Frame.html#网络构成模型" class="sidebar-link">网络构成模型</a></li><li class="sidebar-sub-header"><a href="/blog/Internet/Frame.html#细节部分" class="sidebar-link">细节部分</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="frame-从输入网址到显示网页内容-期间的过程"><a href="#frame-从输入网址到显示网页内容-期间的过程" class="header-anchor">#</a> Frame： 从输入网址到显示网页内容， 期间的过程</h1> <h2 id="流程"><a href="#流程" class="header-anchor">#</a> 流程</h2> <ol><li><p><strong>输入网址(URL)</strong></p> <p>根据URL获取服务器域名和服务器上的资源， 根据这些生成数据包。</p></li> <li><p><strong>目的地——DNS服务器解析服务器域名成IP， 接受目标</strong>。</p></li></ol> <p>DNS服务器可以根据域名解析成网络IP， 用于定位数据包发送的目的地址。</p> <ol start="3"><li><strong>建立友谊——TCP三次握手</strong></li></ol> <p>建立浏览器和服务器的连接，通过TCP三次握手</p> <ol start="4"><li><strong>下一站——MAC地址</strong></li></ol> <p>在知道最终目的地后，但不知道具体的走哪条路（下一站）， 便广播<code>ARP</code>协议报文，在子网内询问IP地址对应的Mac地址</p> <ol start="5"><li><strong>启程——网卡</strong></li></ol> <p>知道下一站后，就开始寻路了。 在网卡的控制下， 将数字信号转化为电信号通过网线传输。</p> <ol start="6"><li><strong>指路者——交换机</strong></li></ol> <p>电信号到达网络接口，交换机进行接收，转换成数字信号。解析并通过<code>FCS</code>校验后，放入缓冲区，查询Mac地址表找网络对应端口发送。</p> <ol start="7"><li><strong>出境大门——路由器</strong></li></ol> <p>数据包经过交换机到达路由器。查询路由表中IP对应的<strong>下一站对应的Mac地址</strong>，继续转发。</p> <ol start="8"><li><strong>到啦！——服务器接收</strong></li></ol> <p>服务器接收到HTTP请求后，解析数据包， 去除MAC,IP，TCP头部，获取HTTP数据，回复HTTP响应报文。</p> <ol start="9"><li><strong>收到啦！——浏览器接收</strong></li></ol> <p>浏览器接收到HTTP响应报文。</p> <ol start="10"><li><strong>显示</strong></li></ol> <p>浏览器读取内容， 解析HTML，生成DOM树，解析CSS，处理JS交互，浏览器和客户端交互。</p> <ol start="11"><li><strong>再见！——四次挥手，断开TCP连接</strong></li></ol> <h2 id="网络构成模型"><a href="#网络构成模型" class="header-anchor">#</a> 网络构成模型</h2> <p><img src="Frame.assets/7.jpg" alt="OSI 参考模型与 TCP/IP 的关系"></p> <h2 id="细节部分"><a href="#细节部分" class="header-anchor">#</a> 细节部分</h2> <h3 id="dns查询"><a href="#dns查询" class="header-anchor">#</a> DNS查询</h3> <p>域名是由<code>.</code>来区分的， 如<code>www.google.com</code>。 因此， 域名也是分层的，对应不同的DNS服务器，一层一层询问，直到查询到IP。</p> <p><strong>域名的层级关系类似一个树状结构</strong>：</p> <ul><li>根 DNS 服务器（.）</li> <li>顶级域 DNS 服务器（.com）</li> <li>权威 DNS 服务器（google.com）</li></ul> <img src="Frame.assets/image-20220603111327553.png" alt="image-20220603111327553" style="zoom:50%;"> <p>当然， 查询DNS服务器之前，会查询缓存。</p> <p><strong>浏览器缓存 --&gt; 操作系统缓存 --&gt; hosts文件 --&gt; DNS服务器</strong>。</p> <h3 id="协议栈"><a href="#协议栈" class="header-anchor">#</a> 协议栈</h3> <p>通过 DNS 获取到 IP 后，就可以把 HTTP 的传输工作交给操作系统中的<strong>协议栈</strong>。</p> <p>协议栈的内部分为几个部分，分别承担不同的工作。上下关系是有一定的规则的，上面的部分会向下面的部分委托工作，下面的部分收到委托的工作并执行。</p> <p><img src="Frame.assets/image-20220603112009333.png" alt="image-20220603112009333"></p> <p>应用程序（浏览器）通过调用 Socket 库，来委托协议栈工作。协议栈的上半部分有两块，分别是负责收发数据的 TCP 和 UDP 协议，这两个传输协议会接受应用层的委托执行收发数据的操作。</p> <p>协议栈的下面一半是用 IP 协议控制网络包收发操作，在互联网上传数据时，数据会被切分成一块块的网络包，而将网络包发送给对方的操作就是由 IP 负责的。</p> <p>此外 IP 中还包括 <code>ICMP</code> 协议和 <code>ARP</code> 协议。</p> <ul><li><code>ICMP</code> 用于告知网络包传送过程中产生的错误以及各种控制信息。</li> <li><code>ARP</code> 用于根据 IP 地址查询相应的以太网 MAC 地址。</li></ul> <p>IP 下面的网卡驱动程序负责控制网卡硬件，而最下面的网卡则负责完成实际的收发操作，也就是对网线中的信号执行发送和接收操作。</p> <p><strong>HTTP基于TCP协议传输。</strong></p> <h3 id="mac地址"><a href="#mac地址" class="header-anchor">#</a> Mac地址</h3> <p>类似DNS查询IP，获取Mac地址时， 操作系统会把ARP查询结果缓存。</p> <p>MAC 地址在以太网内进行<strong>两个设备</strong>之间的包传输。转发的过程中，源IP地址和目标IP地址是不会变的，源MAC地址和目标MAC地址是会变化的。</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/6/2022, 8:45:09 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.a976d4b9.js" defer></script><script src="/blog/assets/js/2.077fc20b.js" defer></script><script src="/blog/assets/js/8.1dbfb293.js" defer></script>
  </body>
</html>
